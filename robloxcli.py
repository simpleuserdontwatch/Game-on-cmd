import curses,traceback,time
screen = curses.initscr()
curses.noecho()
curses.curs_set(0)
screen.keypad(1)
curlevel = 0
# Some kinda of level editor
levels = [['...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'.................#..................####.......................................',
'..................................#............................................',
'....level.1.....................#..............................................',
'............................###................................................',
'.......###.#..#####..#..###....................................................',
'......###......................................................................',
'#..######................................#....Finish...........................',
'..............................................V................................',
'...............................................................................',
'..............................................!................................',
'...........................................#######.............................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',],

['...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'....level.2....................................................................',
'......spike....................................................................',
'......V..........#####.........................................................',
'......^.........^#.............................................................',
'#..######.####.###.............................................................',
'...............................................................................',
'......................!........................................................',
'......................#........................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',],

['...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'.............................................#.................................',
'.............................................#.................................',
'....level.3..................................#.................................',
'.............................................#.................................',
'.......###.#..#####..#..####################.#.................................',
'......###..................................^.^.................................',
'#..######..................................^.^.................................',
'...........................................^.^.................................',
'...........................................^.^.................................',
'...........................................^!^.................................',
'...........................................###.................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',],

['...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'.............................................#.................................',
'.............................................#.................................',
'....level.4.(level 3 but harder)...............................................',
'.............................................#.................................',
'...........#..#..#.#.#..#####..#..#..#######.#.................................',
'......###..................................^.^.................................',
'#..######..................................^.^.................................',
'...........................................^.^.................................',
'...........................................^.^.................................',
'...........................................^.^.................................',
'...........................................^.^.................................',
'...........................................^.^.................................',
'...........................................^......!............................',
'...........................................^^######............................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',],

['...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'....level.5....................................................................',
'....end.(look.close.at.bottom).................................................',
'...............................................................................',
'...............................................................................',
'.....^^........................................................................',
'#..######......................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'........^!^....................................................................',
'........###....................................................................',],

['...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'.............#####.............................................................',
'...............................................................................',
'...............................................................................',
'............#.....#............................................................',
'...............................................................................',
'....level.6....................................................................',
'...........#.......#...........................................................',
'.......................#.......................................................',
'.......................#^!^....................................................',
'#..#########........#######....................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',],

['...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'....level.7....................................................................',
'....just.get.to.win............................................................',
'...............................................................................',
'............############^!^....................................................',
'#..#########...................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',],

['...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'....end........................................................................',
'....Press.Q.to.exit............................................................',
'...............................................................................',
'...............................................................................',
'#..######......................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',
'...............................................................................',],
]

y = 4
x = 0
yvel = 0
screen.nodelay(1)
curses.mousemask(1)
curses.mouseinterval(0)
try:
    while True:
        event = screen.getch()
        if event == ord("q"): break
        for c,i in enumerate(levels[curlevel]):
            screen.addstr(c,0,i)
        screen.addstr(y,x,'0')
        if event == ord("w"):
            try:
                if levels[curlevel][y+1][x] == '#':
                    yvel=3
            except:
                pass
        if event == ord("a"):
            try:
                if not levels[curlevel][y][x-1] == '#':
                    x-=1
            except:
                pass
        if event == ord("d"):
            try:
                if not levels[curlevel][y][x+1] == '#':
                    x+=1
            except:
                pass
        if yvel > 0:
            if not levels[curlevel][y-1][x] == '#':
                y-=yvel
            else:
                y+=1
            yvel-=1
        if not levels[curlevel][y+1][x] == '#':
            y+=1
        if levels[curlevel][y][x] == '!':
            curlevel +=1
            y = 4
            x = 0
        elif levels[curlevel][y][x] == '^':
            raise Exception('You died')
        _, mx,my,_,_ = curses.getmouse()
        screen.addstr(my,mx,'<')
        time.sleep(0.1)
except:
    curses.endwin() # Huston we have a problem
    traceback.print_exc()
curses.endwin()
